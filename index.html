
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quiz Player</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
  <!-- Firebase compat SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="app.js"></script>
  <script src="questions.js"></script>
  <!-- Tailwind (CDN) for toast styling; disable preflight to avoid CSS reset conflicts -->
  <script>
    window.tailwind = window.tailwind || {};
    window.tailwind.config = { corePlugins: { preflight: false } };
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Desktop-only compaction for index page */
    @media (min-width: 700px){
      body.index-page .header{ padding:12px 16px; }
      body.index-page .main{ padding:16px; gap:12px; }
      body.index-page .card{ padding:10px 14px; }
      body.index-page .footer{ padding:10px 16px; }
    }
    @media (min-width:700px){
  body.index-page .container{ width: min(720px, 100%); } /* ‡∏´‡∏£‡∏∑‡∏≠ 680 / 640 ‡∏ï‡∏≤‡∏°‡∏ä‡∏≠‡∏ö */
}
  </style>
</head>
<body class="index-page">
  <!-- Toast stack -->
  <div id="toast-root" class="fixed top-4 right-4 z-[1200] space-y-2 pointer-events-none"></div>
  <!-- Animated background: subtle grid + floating doodles -->
  <div class="animated-bg" aria-hidden="true">
    <div class="bg-grid"></div>
    <div class="bg-doodles">
      <span class="doodle" style="--x:8%;  --size:44px; --delay:0s;">üéØ</span>
      <span class="doodle" style="--x:22%; --size:36px; --delay:2s;">üéÆ</span>
      <span class="doodle" style="--x:38%; --size:40px; --delay:1s;">üèÜ</span>
      <span class="doodle" style="--x:56%; --size:42px; --delay:3s;">‚≠ê</span>
      <span class="doodle" style="--x:72%; --size:34px; --delay:1.6s;">üéØ</span>
      <span class="doodle" style="--x:88%; --size:38px; --delay:2.6s;">üéÆ</span>
    </div>
  </div>

  <div class="container">
    <div class="header">
      <div class="brand"><span class="dot"></span> <span>Vayu Few Few~~</span></div>
      <div class="badge">Room: <span class="mono" id="roomLabel"></span></div>
    </div>

    <div class="main">

      <section id="joinCard" class="card center">
        <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÄ‡∏Å‡∏°</h2>
        <p class="muted">‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°"</p>
        <input id="nameInput" class="name-input" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." maxlength="24" />
        <button id="btnStart" class="btn primary">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
      </section>

      <section id="confirmCard" class="card center hidden">
        <h2>‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏°‡∏±‡πâ‡∏¢‡∏à‡πâ‡∏∞?</h2>
        <p class="muted">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏à‡∏±‡∏î‡πÄ‡∏•‡∏¢‡∏¢‡∏¢</p>
        <div class="row">
          <button id="btnReallyStart" class="btn success">‡∏û‡∏£‡πâ‡∏≠‡∏°! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏¢</button>
        </div>
      </section>

      <section id="quizCard" class="card hidden">
        <div class="row" style="justify-content:space-between; align-items:center; margin-bottom:12px;">
          <div class="badge">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô: <span id="playerName" class="mono"></span></div>
          <div class="badge">‡∏Ç‡πâ‡∏≠ <span id="qIndex">1</span>/<span id="qTotal">20</span></div>
        </div>
        <div class="progress" aria-label="time">
          <div id="timeBar" class="progress__bar"></div>
        </div>
        <div style="height:12px"></div>
        <h3 id="qText"></h3>
        <div id="choiceList" class="choices"></div>
      </section>

      <section id="resultCard" class="card center hidden">
        <h2>‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!</h2>
        <p>‡∏≠‡∏¢‡πà‡∏≤‡∏û‡∏∂‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ! ‡∏£‡∏≠‡πÄ‡∏â‡∏•‡∏¢‡∏à‡∏≤‡∏Å‡∏û‡∏µ‡πà‡πÄ‡∏≠‡∏¥‡∏£‡πå‡∏ó‡∏™‡∏∏‡∏î‡∏´‡∏•‡πà‡∏≠‡∏ô‡∏∞‡∏à‡πä‡∏∞</p>
        <div style="height:20px"></div>
        <div id="answerSummary">
          <h3>‡∏ï‡∏≠‡∏ö‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏±‡πà‡∏á‡∏Ñ‡∏±‡∏ö‡∏ô‡πâ‡∏≠‡∏á</h3>
          <div id="playerAnswers" style="text-align:left; max-width:400px; margin:0 auto;"></div>
        </div>
      </section>

    </div>
    <div class="footer">
      <small class="muted"></small>
      <small class="muted"><span id="roomFooter" class="mono"></span></small>
    </div>
  </div>

<script>
// Simple Tailwind toast helper
window.showToast = function(message, type = 'info', opts = {}){
  try{
    const root = document.getElementById('toast-root');
    if(!root){ alert(message); return; }
    const colors = {
      info:    'bg-slate-800 text-white border border-slate-700',
      success: 'bg-emerald-600 text-white',
      warn:    'bg-amber-500 text-slate-900',
      error:   'bg-rose-600 text-white'
    };
    const icon = {
      info: 'üí¨', success: '‚úÖ', warn: '‚ö†Ô∏è', error: '‚õî'
    }[type] || 'üí¨';
    const div = document.createElement('div');
    div.setAttribute('role','alert');
    div.className = `pointer-events-auto shadow-xl rounded-xl px-3 py-2 flex items-center gap-2 ${colors[type] || colors.info} transition-all duration-200 opacity-0 translate-y-2`;
    div.innerHTML = `<span class="text-lg">${icon}</span><div class="text-sm whitespace-pre-line">${message}</div>`;
    root.appendChild(div);
    requestAnimationFrame(()=>{ div.classList.remove('opacity-0','translate-y-2'); div.classList.add('opacity-100','translate-y-0'); });
    let timeout = setTimeout(close, opts.duration || 3200);
    function close(){
      div.classList.add('opacity-0','translate-y-2');
      setTimeout(()=>{ div.remove(); }, 180);
    }
    div.addEventListener('mouseenter', ()=>{ clearTimeout(timeout); });
    div.addEventListener('mouseleave', ()=>{ timeout = setTimeout(close, 1600); });
    div.addEventListener('click', close);
  }catch(e){ alert(message); }
}

const roomId = window.ROOM_ID;
document.getElementById('roomLabel').textContent = roomId;
document.getElementById('roomFooter').textContent = roomId;

const joinCard = document.getElementById('joinCard');
const confirmCard = document.getElementById('confirmCard');
const quizCard = document.getElementById('quizCard');
const resultCard = document.getElementById('resultCard');

const nameInput = document.getElementById('nameInput');
const btnStart = document.getElementById('btnStart');
const btnReallyStart = document.getElementById('btnReallyStart');

// Debug: Check if elements exist
console.log('DOM Elements check:');
console.log('nameInput:', nameInput);
console.log('btnStart:', btnStart);
console.log('btnReallyStart:', btnReallyStart);

if (!btnStart) {
  console.error('btnStart element not found!');
  window.showToast('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°', 'error');
}

const qText = document.getElementById('qText');
const choiceList = document.getElementById('choiceList');
const timeBar = document.getElementById('timeBar');
const scoreEl = document.getElementById('score');
const qIndexEl = document.getElementById('qIndex');
const qTotalEl = document.getElementById('qTotal');
const playerNameEl = document.getElementById('playerName');
const finalScoreEl = document.getElementById('finalScore');

let uid = null;
let playerRef = null;
let score = 0;
let order = [];
let idx = 0;
let qShownAt = 0;
let timerId = null;
let playerAnswers = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô

const MAX_TIME = window.SPEED_BONUS_WINDOW_MS; // 10s bar
const BAR_TICK_MS = 100;

// Steps
btnStart.addEventListener('click', async ()=>{
  console.log('Start button clicked');
  
  try {
    const name = (nameInput.value || '').trim();
    if(!name){ 
      window.showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠', 'warn'); 
      return; 
    }
    
    console.log('Player name:', name);
    console.log('Attempting to get/create user...');
    
    // Disable button to prevent multiple clicks
    btnStart.disabled = true;
    btnStart.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...';
    
    // Try to get current user or create anonymous user
    let currentUser = firebase.auth().currentUser;
    if (!currentUser) {
      console.log('No current user, signing in anonymously...');
      await firebase.auth().signInAnonymously();
      currentUser = firebase.auth().currentUser;
    }
    
    if (!currentUser) {
      throw new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ');
    }
    
    uid = currentUser.uid;
    console.log('User UID:', uid);
    
    // Create simple unique player ID
    const timestamp = Date.now();
    const random = Math.floor(Math.random() * 10000);
    const playerId = `player_${timestamp}_${random}`;
    console.log('Generated player ID:', playerId);
    
    playerRef = firebase.firestore().collection('rooms').doc(roomId).collection('players').doc(playerId);
    console.log('Player reference created for room:', roomId);
    
    console.log('Saving player data to Firestore...');
    const playerData = { 
      name: name, 
      score: 0, 
      ready: false, 
      playerId: playerId,
      joinedAt: firebase.firestore.FieldValue.serverTimestamp() 
    };
    
    console.log('Player data:', playerData);
    await playerRef.set(playerData);
    
    console.log('Player data saved successfully');

    // Store reference globally for score updates
    window.currentPlayerRef = playerRef;
    window.currentPlayerId = playerId;

    playerNameEl.textContent = name;
    joinCard.classList.add('hidden');
    confirmCard.classList.remove('hidden');
    
  } catch (error) {
    console.error('Error details:', error);
    console.error('Error code:', error.code);
    console.error('Error message:', error.message);
    
    let errorMsg = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message;
    
    if (error.code === 'permission-denied') {
      errorMsg += '\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firestore Security Rules';
    } else if (error.code === 'unauthenticated') {
      errorMsg += '\n\n‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£ Authentication';
    }
    
  window.showToast(errorMsg, 'error');
  } finally {
    // Re-enable button
    btnStart.disabled = false;
    btnStart.textContent = '‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°';
  }
});

// Removed cancel button flow

document.getElementById('btnReallyStart').addEventListener('click', async function() {
  try {
    const confirmCard = document.getElementById('confirmCard');
    const quizCard = document.getElementById('quizCard');
    
    // Update player as ready using the stored reference
    if (window.currentPlayerRef) {
      await window.currentPlayerRef.set({ ready: true }, { merge: true });
      console.log('Player marked as ready');
    }
    
    confirmCard.classList.add('hidden');

    // build shuffled order of up to 20 questions
    if (!window.QUESTION_BANK) {
  window.showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö questions.js', 'error');
      return;
    }
    
    const total = Math.min(20, window.QUESTION_BANK.length);
    const baseOrder = window.shuffle(window.QUESTION_BANK).slice(0, total);
    // Shuffle choices per question (per player) while keeping correct answer mapping
    order = baseOrder.map((q)=>{
      const idxs = q.choices.map((_, i)=> i);
      const shuffled = (window.shuffle ? window.shuffle(idxs) : idxs.sort(()=> Math.random() - 0.5));
      const choices = shuffled.map(i => q.choices[i]);
      const answer = shuffled.indexOf(q.answer);
      return { ...q, choices, answer };
    });
    idx = 0; 
    score = 0;
    playerAnswers = []; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
    if (qTotalEl) { qTotalEl.textContent = String(order.length); }
    quizCard.classList.remove('hidden');
    showQuestion();
    
  } catch (error) {
    console.error('Error starting quiz:', error);
    window.showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°: ' + error.message, 'error');
  }
});

function showQuestion(){
  const resultCard = document.getElementById('resultCard');
  const quizCard = document.getElementById('quizCard');
  const qIndexEl = document.getElementById('qIndex');
  const qText = document.getElementById('qText');
  const choiceList = document.getElementById('choiceList');
  
  if(idx >= order.length){
    // finish - ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
    console.log('Game finished. Final score:', score);
    displayPlayerAnswers();
    resultCard.classList.remove('hidden');
    quizCard.classList.add('hidden');
    
    // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï score ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
    if (window.currentPlayerRef) {
      console.log('Updating final score to Firestore:', score);
      window.currentPlayerRef.set({ 
        score: score,
        gameCompleted: true,
        completedAt: firebase.firestore.FieldValue.serverTimestamp()
      }, {merge:true}).then(() => {
        console.log('Final score updated successfully');
      }).catch((error) => {
        console.error('Error updating final score:', error);
      });
    }
    return;
  }

  const q = order[idx];
  qIndexEl.textContent = String(idx+1);
  qText.textContent = q.text;
  choiceList.innerHTML = '';

  const now = performance.now();
  qShownAt = now;
  startBar(now);

  q.choices.forEach((label, i)=>{
    const btn = document.createElement('button');
    btn.className = 'choice';
    btn.textContent = label;
    btn.addEventListener('click', ()=>answer(q, i, btn));
    choiceList.appendChild(btn);
  });
}

function startBar(start){
  timeBar.style.width = '0%';
  if(timerId) cancelAnimationFrame(timerId);
  const tick = ()=>{
    const elapsed = performance.now() - start;
    const ratio = Math.min(1, elapsed / MAX_TIME);
    timeBar.style.width = (ratio*100).toFixed(2) + '%';
    if(ratio < 1){ timerId = requestAnimationFrame(tick); }
  };
  timerId = requestAnimationFrame(tick);
}

async function answer(q, i, btnEl){
  const choiceList = document.getElementById('choiceList');
  
  // disable all buttons
  Array.from(choiceList.children).forEach(ch=>ch.disabled = true);
  if(timerId) cancelAnimationFrame(timerId);

  const elapsed = performance.now() - qShownAt;
  const correct = (i === q.answer);
  const pts = window.computePoints ? window.computePoints(correct, elapsed) : (correct ? 100 : 0);
  
  console.log('Answer processing:', {
    questionIndex: idx + 1,
    playerChoice: i,
    correctAnswer: q.answer,
    isCorrect: correct,
    elapsed: elapsed,
    points: pts,
    hasComputePoints: !!window.computePoints
  });

  // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
  playerAnswers.push({
    questionIndex: idx,
    questionText: q.text,
    playerChoice: i,
    playerChoiceText: q.choices[i],
    correctAnswer: q.answer,
    correctAnswerText: q.choices[q.answer],
    isCorrect: correct,
    points: pts
  });

  // ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á - ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß
  btnEl.style.backgroundColor = '#e5e7eb';
  btnEl.style.borderColor = '#9ca3af';

  // update score (‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤)
  if(correct){
    score += pts;
    console.log(`Question ${idx + 1}: Correct! Points: ${pts}, Total score: ${score}`);
  } else {
    console.log(`Question ${idx + 1}: Wrong. Points: 0, Total score: ${score}`);
  }
  
  console.log('Answer details:', {
    questionIndex: idx,
    correct: correct,
    points: pts,
    totalScore: score,
    elapsed: elapsed
  });
  
  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Firestore
  try{
    if (window.currentPlayerRef) {
      console.log('Updating score in Firestore:', score);
      await window.currentPlayerRef.set({
        score: score,
        lastAnswerAt: firebase.firestore.FieldValue.serverTimestamp(),
      }, {merge:true});
      console.log('Score updated in Firestore successfully');
    } else {
      console.error('currentPlayerRef is null!');
    }
  }catch(e){ 
    console.error('Error updating score:', e); 
  }

  // ‡πÑ‡∏õ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ
  setTimeout(()=>{
    idx++;
    showQuestion();
  }, 800);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å" ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏â‡∏•‡∏¢/‡πÑ‡∏°‡πà‡∏ö‡∏≠‡∏Å‡∏ñ‡∏π‡∏Å‡∏ú‡∏¥‡∏î
function displayPlayerAnswers() {
  const playerAnswersEl = document.getElementById('playerAnswers');
  if (!playerAnswersEl) return;

  // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
  let html = '';
  playerAnswers.forEach((ans, i) => {
    html += `
      <div style="
        margin-bottom:12px;
        padding:12px;
        border:1px solid #e5e7eb;
        border-radius:10px;
        background:#fff;">
        <div style="font-weight:700; margin-bottom:6px;">‡∏Ç‡πâ‡∏≠ ${i + 1}</div>
        <div style="font-size:15px; color:#374151;">
          <div style="margin-bottom:6px;"><strong>‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°:</strong> ${ans.questionText}</div>
          <div><strong>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏á‡πÜ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</strong> ${ans.playerChoiceText}</div>
        </div>
      </div>
    `;
  });

  // ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏•‡πá‡∏Å ‡πÜ (‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö)
  const total = playerAnswers.length;
  html = `
    <div style="
      text-align:center;
      margin-bottom:16px;
      padding:14px;
      background:linear-gradient(45deg,#f3f4f6,#e5e7eb);
      border-radius:12px;">
      <div style="font-size:16px;">‡∏ï‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <strong>${total}</strong> ‡∏Ç‡πâ‡∏≠</div>
    </div>
  ` + html;

  playerAnswersEl.innerHTML = html;
}

</script>
</body>
</html>
